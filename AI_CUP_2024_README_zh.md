
# AI CUP 2024 - 基於區域微氣候資料預測發電量

## 團隊資訊

- **隊伍名稱**: TEAM_5709  
- **比賽成績**:  
  - **Private Leaderboard 分數**: 310,872.06  
  - **Private Leaderboard 排名**: 第 1 名  
- **隊員**:  
  - 隊長: 林靖鈞 (Lin Jingjun)  

---

## 專案簡介

本專案參加 AI CUP 2024 秋季賽，主題為基於區域微氣候資料進行太陽能發電量的預測。我們的解決方案結合了創新的特徵工程策略與高效的堆疊回歸模型，在排行榜中取得了第一名的佳績。

---

## 專案目標

- **準確預測**: 基於區域氣象數據進行太陽能發電量的高精度預測。  
- **高效建模**: 使用多種基礎模型與堆疊回歸框架提升預測效果。  
- **創新策略**: 通過天氣特徵交換等方法提升數據多樣性與模型泛化能力。  
- **通用應用**: 為新建電廠提供選址與效能評估參考。  

---

## 環境設置

- **開發語言**: Python 3  
- **開發環境**: Jupyter Notebook  
- **作業系統**: Ubuntu 24.04  
- **使用套件**:
  ```text
  numpy==1.24.3
  pandas==1.5.3
  matplotlib==3.7.1
  seaborn==0.12.2
  yellowbrick==1.5
  scikit-learn==1.2.2
  xgboost==1.7.6
  lightgbm==3.3.5
  catboost==1.2
  ```

### 硬體配置

- **伺服器**:  
  - **CPU**: AMD Ryzen 7 8845HS  
  - **記憶體**: 64GB  
  - **GPU**: 無  
- **筆電**:  
  - **CPU**: AMD Ryzen 5 4600H  
  - **記憶體**: 32GB  
  - **GPU**: 無  

---

## 核心方法

### 資料處理

1. **異常值處理**: 根據颱風與豪雨數據剔除異常樣本，並進行標準化處理。  
2. **數據集擴建**: 使用「天氣特徵交換」方法，將訓練數據從 11 萬筆擴增至 75 萬筆。  
3. **降頻與粒度調整**:  
   - 訓練數據: 使用 10 分鐘級別的降頻數據以降低噪音。  
   - 測試數據: 恢復至分鐘級別以提升精度。  
4. **特徵工程**:  
   - **時間相關特徵**: 提取小時、分鐘、週期性特徵（如 cos/sin 轉換）。  
   - **光照數據特徵**: 包括均值、標準差及正規化處理。

### 模型架構

- **第一層模型（基礎模型）**:  
  - **RandomForest (RFRA)**: 使用絕對誤差作為損失函數，搭建 1,000 棵決策樹。  
  - **HistGradientBoosting (HGBR)**: 基於直方圖方法的梯度提升，啟用早停機制。  
  - **CatBoost Regressor (CatBoostR)**: 支援類別數據建模，對數據順序不敏感。  
  - **LightGBM (LGBM)**: 配置不同損失函數以適應多樣數據特性。  

- **第二層模型（堆疊模型）**:  
  - 使用 LightGBM 作為最終預測器，增加隨機性以提升泛化能力。

### 創新技術

- **天氣特徵交換**: 提升數據多樣性並學習跨站點相關性。  
- **偽標籤（Pseudo-Labeling）**: 通過多輪迭代優化預測結果。  
- **靈活時間粒度應用**: 結合低噪音訓練數據與高粒度測試數據提升穩定性與精度。

---

## 成果與啟示

### 競賽成果

1. **模型效能**:  
   - 採用堆疊回歸模型取得了最高的排行榜成績。  
   - 有效提升不同氣象條件下的預測準確性。  

2. **創新貢獻**:  
   - 提出天氣特徵交換策略，充分挖掘微氣候數據的潛力。  
   - 設計可擴展的預測框架，適用於無歷史數據的新建電廠。

### 模型比較

- **堆疊模型 vs. CNN-LSTM**:  
  - CNN-LSTM 在預測時間範圍延長時誤差顯著增加。  
  - 堆疊回歸模型在整體準確性與穩定性上更具優勢。  

---

## 使用指南

### 環境設置

1. 安裝 Python 3 和 Conda。  
2. 創建虛擬環境並安裝依賴套件：  
   ```bash
   conda create -n aicup python=3.8
   conda activate aicup
   pip install -r requirements.txt
   ```

### 執行步驟

1. **數據處理**: 執行數據預處理腳本生成訓練與測試數據。  
2. **模型訓練**: 訓練堆疊回歸模型並保存結果。  
3. **模型評估**: 評估模型性能並生成可視化報告。

---

## 聯絡資訊

- **隊長**: 林靖鈞 (Lin Jingjun)  
- **學校**: 國立竹北高中普通科  
- **Email**: xup6vu84m3ul6@gmail.com  

---

## 授權聲明

本專案僅供學術用途，若需用於商業目的或再發布，請聯繫作者獲得授權。

---

## 參考文獻與外部資源

1. Tovar, M. et al. (2020). *PV Power Prediction using CNN-LSTM hybrid neural network model*.  
2. Himawari 衛星數據: [NOAA Himawari](https://registry.opendata.aws/noaa-himawari)  
3. 環境署空氣品質資料: [MOE](https://data.moenv.gov.tw/dataset/detail/AQX_P_35)  

更多細節請參閱競賽報告。
